# Listbox

An implementation of a listbox. While any DOM content is permissible as a child of the listbox, only `FluentOption` elements, `option` elements, and slotted items with `role="option"` will be treated as options and receive keyboard support.

The `<FluentListbox>` supports data binding but does not hook into any events.

`<FluentListbox>` wraps the `<fluent-listbox>` element, a web component implementation of a listbox leveraging the Fluent UI design system.

## Examples

### Manual

<div style="border: 1px solid var(--neutral-stroke-rest); border-radius: 4px; padding: 4px;">
    <div style="padding: 8px;">This option has no value</div>
    <div style="padding: 8px; opacity: var(--disabled-opacity); color: var(--neutral-foreground-disabled);">This option is disabled</div>
    <div style="padding: 8px;">This option has a value</div>
    <div style="padding: 8px;">
        <svg width="16" height="16" fill="currentColor"><path d="M...Z"/></svg>
        This option has <b>an icon</b>
    </div>
    <div style="padding: 8px; background-color: var(--accent-fill-rest); color: var(--color-on-accent-fill-rest); border-radius: 4px;">
        <div style="display:flex; flex-direction:row; align-items: center; gap: 4px;">
            <img style="width:20px" src="_content/FluentUI.Demo.Shared/flags/nl.svg">
            This option is selected by default
        </div>
    </div>
</div>
<p>Selected: Item 4</p>

```razor
<FluentListbox TOption="string" ValueChanged="@(e => listboxValue = e)">
    <FluentOption>This option has no value</FluentOption>
    <FluentOption Value="Item 1" Disabled="true">This option is disabled</FluentOption>
    <FluentOption Value="Item 2">This option has a value</FluentOption>
    <FluentOption Value="Item 3">
        <FluentIcon Value="@(new Icons.Regular.Size16.Folder())" Slot="start" />
        This option has <b>an icon</b>
    </FluentOption>
    <FluentOption Value="Item 4" Selected=true>
        <div style="display:flex; flex-direction:row">
            <img style="width:20px" src="_content/FluentUI.Demo.Shared/flags/nl.svg" />This option is selected by default
        </div>
    </FluentOption>
</FluentListbox>

<p>Selected: @listboxValue</p>

@code {
    string? listboxValue = "Item 4";
}
```

### Default

<label>Select a person</label>
<div style="border: 1px solid var(--neutral-stroke-rest); border-radius: 4px; padding: 4px; height: 150px; overflow-y: auto;">
    <!-- Options would be rendered here -->
</div>
<p>Selected value: <br> Selected item:</p>

```razor
@inject DataSource Data

<FluentListbox TOption="Person"
               Label="Select a person"
               Items="@Data.People"
               Id="people-listbox"
               Height="150px"
               OptionValue="@(p => p.PersonId.ToString())"
               OptionText="@(p => p.LastName + ", " + p.FirstName)"
               @bind-Value="@SelectedValue"
               @bind-SelectedOption="@SelectedItem" />

<p>
    Selected value: @SelectedValue <br />
    Selected item: @SelectedItem?.ToString()
</p>

@code
{
    Person? SelectedItem;
    string? SelectedValue;
}
```

### From a list of `Option<T>` items

<h4>From a List of Option&lt;string&gt; items</h4>
<p>Second item in the list is initially selected through the <code>OptionSelected</code> (Func delegate) parameter.</p>
<div style="border: 1px solid var(--neutral-stroke-rest); border-radius: 4px; padding: 4px;">
    <div style="padding: 8px;">One</div>
    <div style="padding: 8px; background-color: var(--accent-fill-rest); color: var(--color-on-accent-fill-rest); border-radius: 4px;">Two</div>
    <div style="padding: 8px;">Three</div>
</div>
<p>Selected Value: 2</p>

<h4>From List of Option&lt;int&gt; items</h4>
<p>First item in the list is disabled through the <code>OptionDisabled</code> (Func delegate) parameter.</p>
<div style="border: 1px solid var(--neutral-stroke-rest); border-radius: 4px; padding: 4px;">
    <div style="padding: 8px; opacity: var(--disabled-opacity); color: var(--neutral-foreground-disabled);">1</div>
    <div style="padding: 8px;">2</div>
    <div style="padding: 8px;">3</div>
</div>
<p>Selected Value:<br>Selected Item (strongly typed):<br>Value: (Type:)<br>Text:</p>

```razor
<h4>From a List of Option&lt;string&gt; items</h4>
<p>Second item in the list is initially selected through the <code>OptionSelected</code> (Func delegate) parameter.</p>

<FluentListbox Items=@stringOptions 
               OptionText="@(i => i.Text)" 
               OptionValue="@(i => i.Value)"
               OptionSelected="@(i => i.Selected)"
               @bind-Value="@stringValue" />
<p>
    Selected Value: @stringValue<br />
</p>

<h4>From List of Option&lt;int&gt; items</h4>
<p>First item in the list is disabled through the <code>OptionDisabled</code> (Func delegate) parameter.</p>
<p><em>Note that none of the options is initially highlighted or selected.</em></p>

<FluentListbox Items=@intOptions 
               TOption="Option<int>"
               OptionText="@(i => i.Text)"
               OptionValue="@(i => i.Value.ToString())"
               OptionDisabled="@(i => i.Disabled)"
               @bind-SelectedOption="@selectedIntOption"
               @bind-Value="@intValue" />
<p>
    Selected Value: @intValue<br />
    Selected Item (strongly typed): <br />
    Value: @selectedIntOption?.Value (Type: @(selectedIntOption?.Value.GetType())) <br />
    Text: @selectedIntOption?.Text
</p>

@code {
    string? stringValue;
    string? intValue;
    Option<int>? selectedIntOption;
    
    List<Option<string>> stringOptions = new()
    {
        { new Option<string> { Value = "1", Text = "One" } },
        { new Option<string> { Value = "2", Text = "Two", Selected = true } },
        { new Option<string> { Value = "3", Text = "Three" } }

    };

List<Option<int>> intOptions = new()
    {
        { new Option<int> { Value = 1, Text = "1", Disabled = true } },
        { new Option<int> { Value = 2, Text = "2" } },
        { new Option<int> { Value = 3, Text = "3" } }

    };
}
```

### Option template

<div style="border: 1px solid var(--neutral-stroke-rest); border-radius: 4px; padding: 4px;">
    <!-- Template content would be here -->
</div>
<p>Selected: ( )</p>

```razor
@inject DataSource Data

<FluentListbox Items="@Data.People"
               OptionValue="@(i => i.PersonId.ToString())"
               @bind-SelectedOption=@Person>
    <OptionTemplate>
        <FluentIcon Icon="Icons.Regular.Size16.Person" Slot="end" OnClick="@(() => DemoLogger.WriteLine($"Icon for {@context.LastName} selected"))" />
        @context.FirstName (@context.LastName)
    </OptionTemplate>
</FluentListbox>
<p>
    Selected: @Person?.FirstName (@Person?.LastName)
</p>

@code {
    public Person Person { get; set; } = default!;
}
```

## Documentation

### FluentListbox<TOption> Class

#### Parameters

| Parameter | Type | Default | Description |
| --- | --- | --- | --- |
| **Items** | `IEnumerable<TOption>?` | | The source of all items to display. |
| **Label** | `string?` | | The text label for the input. |
| **Multiple** | `bool` | `False` | If true, the user can select multiple elements. |
| **OptionDisabled** | `Func<TOption, bool>?` | | A function to determine if an option is disabled. |
| **OptionSelected** | `Func<TOption, bool>?` | | A function to determine if an option is initially selected. |
| **OptionTemplate** | `RenderFragment<TOption>?` | | A template for rendering items in the list. |
| **OptionText** | `Func<TOption, string>?` | | A function to determine the text to display for each option. |
| **OptionValue** | `Func<TOption, string>?` | | A function to determine the value to return for the selected item. |
| **SelectedOption** | `TOption?` | | The selected item when `Multiple` is false. |
| **SelectedOptions** | `IEnumerable<TOption>?` | | The selected items when `Multiple` is true. |
| **Size** | `int` | `0` | The maximum number of options visible in the scroll area. |
| **Value** | `string?` | | The value of the input. Use with `@bind-Value`. |
| **Width** | `string?` | | The width of the component. |

#### EventCallbacks

| EventCallback | Type | Description |
| --- | --- | --- |
| **SelectedOptionChanged** | `EventCallback<TOption>` | Called when the selection changes (when `Multiple` is false). |
| **SelectedOptionsChanged**| `EventCallback<IEnumerable<TOption>>` | Called when the selection changes (when `Multiple` is true). ⚠️ Not triggered when using manual options. |
| **ValueChanged** | `EventCallback<string>` | A callback that updates the bound value. |