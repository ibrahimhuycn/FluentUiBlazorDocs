# Virtualized grid

It can be expensive both to fetch and to render large numbers of items. If the amount of data you're displaying might be large, you should use either paging or virtualization.

Virtualization provides the appearance of continuous scrolling through an arbitrarily-large data set, while only needing to fetch and render the rows that are currently in the scroll viewport. This can provide excellent performance even when the data set is vast. `FluentDataGrid`'s virtualization feature is built on Blazor's built-in `Virtualize` component, so it shares the same capabilities, requirements, and limitations.

Enabling virtualization is just a matter of passing `Virtualize="true"`. For it to work properly and reliably, every row rendered must have the same known height. This is handled by the `FluentDataGrid` code.

<div style="height: 400px; max-width: 800px; overflow-y: scroll; border: 1px solid var(--neutral-stroke-rest); border-radius: 4px;">
    <table style="width: 100%; border-collapse: collapse;">
        <thead style="position: sticky; top: 0; background-color: var(--neutral-layer-1);">
            <tr>
                <th style="width: 25%; padding: 8px; border-bottom: 1px solid var(--neutral-stroke-rest); text-align: left;">Item1</th>
                <th style="width: 25%; padding: 8px; border-bottom: 1px solid var(--neutral-stroke-rest); text-align: left;">Item2</th>
                <th style="width: 25%; padding: 8px; border-bottom: 1px solid var(--neutral-stroke-rest); text-align: center;">Item3</th>
                <th style="width: 25%; padding: 8px; border-bottom: 1px solid var(--neutral-stroke-rest); text-align: right;">Item4</th>
            </tr>
        </thead>
        <tbody>
            <!-- Virtualized rows would be rendered here -->
        </tbody>
    </table>
</div>
<br>
<div style="display: flex; gap: 1rem;">
    <!-- Placeholder for Switch and Button -->
    <label>Toggle Items</label>
    <button>Simulate data loading</button>
</div>

```razor
<div style="height: 400px; max-width: 800px; overflow-y: scroll;">
    <FluentDataGrid @ref="grid" Items=@items Virtualize="true" DisplayMode="DataGridDisplayMode.Table" Style="width: 100%;" ItemSize="54" GenerateHeader="@GenerateHeaderOption.Sticky">
        <ChildContent>
            <PropertyColumn Width="25%" Property="@(c => c.Item1)" Sortable="true" />
            <PropertyColumn Width="25%" Property="@(c => c.Item2)" />
            <PropertyColumn Width="25%" Property="@(c => c.Item3)" Align="Align.Center" />
            <PropertyColumn Width="25%" Property="@(c => c.Item4)" Align="Align.End" />
        </ChildContent>
        <EmptyContent>
            <FluentIcon Value="@(new Icons.Filled.Size24.Crown())" Color="@Color.Accent" />&nbsp; Nothing to see here. Carry on!
        </EmptyContent>
        <LoadingContent>
            <FluentStack Orientation="Orientation.Vertical" HorizontalAlignment="HorizontalAlignment.Center">
                Loading...<br />
                <FluentProgress Width="240px" />
            </FluentStack>
        </LoadingContent>
    </FluentDataGrid>
</div>
<br />
<FluentSwitch @ref="_clearToggle"
              @bind-Value="@_clearItems"
              @bind-Value:after="ToggleItems"
              UncheckedMessage="Clear all results"
              CheckedMessage="Restore all results">
</FluentSwitch>
<FluentButton OnClick="SimulateDataLoading">Simulate data loading</FluentButton>

@code {
    FluentDataGrid<SampleGridData>? grid;
    FluentSwitch? _clearToggle;

    bool _clearItems = false;
    public record SampleGridData(string Item1, string Item2, string Item3, string Item4);

    IQueryable<SampleGridData>? items = Enumerable.Empty<SampleGridData>().AsQueryable();

    private IQueryable<SampleGridData> GenerateSampleGridData(int size)
    {
        SampleGridData[] data = new SampleGridData[size];

        for (int i = 0; i < size; i++)
        {
            data[i] = new SampleGridData($"value {i}-1", $"value {i}-2", $"value {i}-3", $"value {i}-4");
        }
        return data.AsQueryable();
    }
    protected override void OnInitialized()
    {
        items = GenerateSampleGridData(5000);
    }

    private void ToggleItems()
    {
        if (_clearItems)
        {
            items = null;
        }
        else
        {
            items = GenerateSampleGridData(5000);
        }
    }

    private async Task SimulateDataLoading()
    {
        _clearItems = false;

        items = null;
        grid?.SetLoadingState(true);

        await Task.Delay(1500);

        items = GenerateSampleGridData(5000);
        grid?.SetLoadingState(false);
    }
}
```