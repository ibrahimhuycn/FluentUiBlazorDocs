# KeyCode

## Section

In some circumstances, Blazor does not retrieve all the `KeyDown` information received from JavaScript. `FluentKeyCode` retrieves this data, in a similar way to the JavaScript KeyCode library and to this demo sample.

The `FluentKeyCode` component extends the functionality of `OnKeyDown` by adding the `KeyCode` property when the `OnKeyDown` event is raised.

<div style="display: flex; gap: 2rem;">
    <div tabindex="0" style="width: 300px; height: 140px; padding: 1rem; border: 1px solid var(--neutral-stroke-rest); border-radius: 4px;">
        Click here and press <span style="font-weight: bold;">any key</span> to get the event keycode info.
    </div>
    <ul style="list-style-type: none; padding: 0;">
        <li><span style="float: left; width: 70px; font-weight: bold;">Value:</span> <code></code></li>
        <li><span style="float: left; width: 70px; font-weight: bold;">Key:</span> <code></code></li>
        <li><span style="float: left; width: 70px; font-weight: bold;">Code:</span> <code></code></li>
        <li>
            <span style="float: left; width: 70px; font-weight: bold;">Meta:</span>
            <!-- Icons for Shift, Ctrl, Alt, Meta -->
        </li>
        <li><span style="float: left; width: 70px; font-weight: bold;">Location:</span> <code></code></li>
        <li><span style="float: left; width: 70px; font-weight: bold;">TargetId:</span> <code></code></li>
        <li><span style="float: left; width: 70px; font-weight: bold;">Repeat:</span> <code></code></li>
    </ul>
</div>

```razor
<FluentStack>
    <FluentKeyCode OnKeyDown="@KeyDownHandler">
        <FluentCard tabindex="0" Width="300px" Height="140px">
            Click here and press <FluentKeyCode tabindex="0" OnKeyDown="@KeyDownHandler" StopPropagation="true">any key</FluentKeyCode> to get the event keycode info.
        </FluentCard>
    </FluentKeyCode>

    <ul>
        <!-- List items for key details -->
    </ul>
</FluentStack>

@code
{
    FluentKeyCodeEventArgs? LastKeyCode;

    void KeyDownHandler(FluentKeyCodeEventArgs e)
    {
        LastKeyCode = e;
    }
}
```

## Global

You can also capture keystrokes globally on the current page. To do this, we provide you with an `IKeyCodeService` injected by the `AddFluentUIComponents` method. Add the following component at the end of your `MainLayout.razor` file: `<FluentKeyCodeProvider />`

Once the provider and service have been injected, you can:

1.  **Retrieve the service and register a method:**
    ```csharp
    [Inject]
    private IKeyCodeService KeyCodeService { get; set; }

    protected override void OnInitialized()
    {
        KeyCodeService.RegisterListener(OnKeyDownAsync);
    }

    public async Task OnKeyDownAsync(FluentKeyCodeEventArgs args) => { // ... }

    public ValueTask DisposeAsync()
    {
        KeyCodeService.UnregisterListener(OnKeyDownAsync);
        return ValueTask.CompletedTask;
    }
    ```

2.  **Implement the `IKeyCodeListener` interface:**
    ```csharp
    public partial class MyPage : IKeyCodeListener, IAsyncDisposable
    {
        [Inject]
        private IKeyCodeService KeyCodeService { get; set; }

        protected override void OnInitialized()
        {
            KeyCodeService.RegisterListener(this);
        }

        public async Task OnKeyDownAsync(FluentKeyCodeEventArgs args) => { // ... }

        public ValueTask DisposeAsync()
        {
            KeyCodeService.UnregisterListener(this);
            return ValueTask.CompletedTask;
        }
    }
    ```

> Some keystrokes are used by the browser (e.g., `Ctrl` + `A`). You can disable this function using the `PreventDefault` attribute with the `FluentKeyCodeProvider` component: `<FluentKeyCodeProvider PreventDefault="true" />`

## Documentation

### FluentKeyCode Class

#### Parameters

| Parameter | Type | Default | Description |
| --- | --- | --- | --- |
| **ChildContent** | `RenderFragment?` | | The content to be managed by the KeyCode engine. |
| **GlobalDocument** | `bool` | `False` | Whether the KeyCode engine is global or scoped to the component's content. |
| **Ignore** | `KeyCode[]` | | A list of `KeyCode`s to ignore. |
| **Only** | `KeyCode[]` | | A list of `KeyCode`s to accept exclusively. |
| **PreventDefault** | `bool` | `False` | Prevents the default action of the event. |
| **StopPropagation** | `bool` | `False` | Prevents further propagation of the event. |
| **StopRepeat** | `bool` | `False` | Whether repeated key presses should be ignored. |

#### EventCallbacks

| EventCallback | Type | Description |
| --- | --- | --- |
| **OnKeyDown** | `EventCallback<FluentKeyCodeEventArgs>` | Triggered when a `KeyDown` event is raised. |
| **OnKeyUp** | `EventCallback<FluentKeyCodeEventArgs>` | Triggered when a `KeyUp` event is raised. |

### FluentKeyCodeEventArgs Class

#### Properties

| Property | Type | Default | Description |
| --- | --- | --- | --- |
| **AltKey** | `bool` | `False` | Indicates if the `Alt` key was pressed. |
| **CtrlKey** | `bool` | `False` | Indicates if the `Control` key was pressed. |
| **Key** | `KeyCode` | `Unknown` | The `KeyCode` equivalent value. |
| **KeyCode** | `int` | `0` | The numerical code identifying the unmodified value of the pressed key. |
| **MetaKey** | `bool` | `False` | Indicates if the `Meta` key was pressed. |
| **Repeat** | `bool` | `False` | True if the key is being held down. |
| **ShiftKey** | `bool` | `False` | Indicates if the `Shift` key was pressed. |
| **TargetId** | `string` | | The ID of the targeted DOM element. |
| **Value** | `string` | | The value of the key pressed. |

### FluentKeyCodeProvider Class

#### Parameters

| Parameter | Type | Default | Description |
| --- | --- | --- | --- |
| **PreventDefault** | `bool` | `False` | Prevents the default action of key events globally. |