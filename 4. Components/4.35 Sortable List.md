# SortableList

A SortableJS library adaptation for Blazor Fluent UI. Allows for reordering elements within a list using drag and drop. Inspired by and based on Burke Holland's article and code. Re-used with permission.

The `FluentSortableList` is a generic component that takes a list of items and an `ItemTemplate` that defines how to render each item in the sortable list.

## How to use this in your own project

If you want to use the `FluentSortableList` component, you will need to include the script in your `index.html`, `_Layout.cshtml`, or `App.razor` file. You can either download from the [SortableJS website](https://sortablejs.github.io/Sortable/) or use a CDN:

```html
<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
```

> We do not include the needed Sortable script in the library.

The component does not actually do any sorting or moving of items. It simply provides the hooks to do so. You will need to handle all events yourself. If you don't handle any events, no sort or move will happen as Blazor needs to make the changes to the underlying data structures so it can re-render the list. Here is an example of how to reorder your list when `OnUpdate` is fired:

```csharp
private void SortList(FluentSortableListEventArgs args)
{
     if (args is null || args.OldIndex == args.NewIndex)
     {
         return;
     }

     var itemToMove = items[args.OldIndex];
     items.RemoveAt(args.OldIndex);

     if (args.NewIndex < items.Count)
     {
         items.Insert(args.NewIndex, itemToMove);
     }
     else
     {
         items.Add(itemToMove);
     }
}
```

## Examples

### Simple sortable list

<div style="border: 1px solid var(--neutral-stroke-rest); border-radius: 4px; padding: 1rem;">
    <div style="padding: 0.5rem; border: 1px solid var(--neutral-stroke-divider-rest);">Item 1</div>
    <div style="padding: 0.5rem; border: 1px solid var(--neutral-stroke-divider-rest);">Item 2</div>
    <div style="padding: 0.5rem; border: 1px solid var(--neutral-stroke-divider-rest);">Item 3</div>
</div>

```razor
<FluentSortableList Items="items" OnUpdate="@SortList">
    <ItemTemplate>@context.Name</ItemTemplate>
</FluentSortableList>

@code {
    public class Item { public int Id { get; set; } public string Name { get; set; } = ""; }
    public List<Item> items = Enumerable.Range(1, 10).Select(i => new Item { Id = i, Name = $"Item {i}" }).ToList();

    private void SortList(FluentSortableListEventArgs args)
    {
        if (args is null || args.OldIndex == args.NewIndex) return;
        var itemToMove = items[args.OldIndex];
        items.RemoveAt(args.OldIndex);
        if (args.NewIndex < items.Count) items.Insert(args.NewIndex, itemToMove);
        else items.Add(itemToMove);
    }
}
```

### Move items between two lists

Shared lists are lists where items can be dragged from one to the other. Providing the same `Group` name for both lists links them.

```razor
<FluentGrid Justify="JustifyContent.FlexStart" Spacing="3">
    <FluentGridItem xs="12" sm="6">
        <h5>List 1</h5>
        <FluentSortableList Id="shared1" Class="darker" Group="sharedLists" OnUpdate="@SortListOne" OnRemove="@ListOneRemove" Items="@items1">
            <ItemTemplate>@context.Name</ItemTemplate>
        </FluentSortableList>
    </FluentGridItem>
    <FluentGridItem xs="12" sm="6">
        <h5>List 2</h5>
        <FluentSortableList Id="shared2" Group="sharedLists" OnUpdate="@SortListTwo" OnRemove="@ListTwoRemove" Items="@items2">
            <ItemTemplate>@context.Name</ItemTemplate>
        </FluentSortableList>
    </FluentGridItem>
</FluentGrid>

@code {
    // C# code for handling moves between lists
}
```

### Drag Handles

When setting the `Handle` parameter to `true`, the items can only be sorted using the drag handle itself.

<div style="border: 1px solid var(--neutral-stroke-rest); border-radius: 4px; padding: 1rem;">
    <div style="padding: 0.5rem; border: 1px solid var(--neutral-stroke-divider-rest); display: flex; align-items: center; gap: 0.5rem;">
        <span style="cursor: grab;">â˜°</span>
        <span>Item 1</span>
    </div>
</div>

```razor
<FluentSortableList Id="dragHandles" Handle="true" Items="items" OnUpdate="@SortList">
    <ItemTemplate>
        <div class="sortable-grab">
            <FluentIcon Value="@(new Icons.Regular.Size20.ArrowSort())" />
        </div>
        <div class="sortable-item-content" style="flex-grow: 1;">@context.Name</div>
    </ItemTemplate>
</FluentSortableList>
```

## Documentation

### FluentSortableList<TItem> Class

#### Parameters
| Parameter | Type | Default | Description |
|---|---|---|---|
| **Items** | `IEnumerable<TItem>?` | | The list of items to be displayed. |
| **ItemTemplate** | `RenderFragment<TItem>?` | | The template for rendering each sortable item. |
| **Group** | `string?` | | The name of the group for dragging between lists. |
| **Sort** | `bool` | `True` | Whether the list is sortable. |
| **Clone** | `bool` | `False` | Whether elements are cloned instead of moved. |
| **Handle** | `bool` | `False` | If true, items can only be dragged by an element with the `.sortable-grab` class. |
| **ItemFilter** | `Func<TItem, bool>?` | | A function to filter out elements that cannot be sorted or moved. |

#### EventCallbacks
| EventCallback | Type | Description |
|---|---|---|
| **OnUpdate** | `EventCallback<FluentSortableListEventArgs>` | Fired when the list is updated (item sorted within the same list). |
| **OnRemove** | `EventCallback<FluentSortableListEventArgs>` | Fired when an item is removed from the list (moved to another list). |

### FluentSortableListEventArgs Class

#### Properties
| Property | Type | Description |
|---|---|---|
| **OldIndex** | `int` | The index of the item before the update. |
| **NewIndex** | `int` | The index of the item after the update. |
| **FromListId** | `string` | The ID of the list the item was in before the update. |
| **ToListId** | `string` | The ID of the list the item is in after the update. |